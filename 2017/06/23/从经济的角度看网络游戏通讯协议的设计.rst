从经济的角度看网络游戏通讯协议的设计
*************************************

分析网络游戏通讯协议的大小是如何影响赢利的。

.. author:: default
.. categories:: Network, Game Develop
.. tags:: Game Develop
.. comments::

因为最近参加一个开发MOBA类游戏，研究帧同步的时候，因为设计中客户端与服务端的数据传输是不间断\
的（没有任何动作都会向服务器发数据）。感觉有点奇怪，想着想着就想到带宽成本的问题，以当前的通\
讯方式，百兆带宽需要多少玩家才能保证赢利。如此有了此文。

通讯协议的大小，影响着游戏对带宽的需求，所以协议包的大小，通讯频率，玩家的数量决定着服务器所\
需要的带宽，进而影响到运营成本。再考虑一下玩家的付费率，平均付费额，就可以做出通讯协议的设计\
会对运营成本，营利的影响了。

流量成本
========

+--------+-----------------+----------------+
| 供应商 | 100M带宽3年(元) | 平均每月 (元)  |
+--------+-----------------+----------------+
| 百度云 | 73056.6(83折)   | 2000           |
+--------+-----------------+----------------+
| 腾讯云 | 86203.4(83折)   | 2400           |
+--------+-----------------+----------------+
| 阿里云 | 78795.0         | 2200           |
+--------+-----------------+----------------+

.. note::

    2017年06月24日

当前游戏的带宽成本计算
=======================
游戏战斗部分以帧同步模式运行，服务器每25ms向战斗中所有用户广播一帧，所以平均1s大概要广播40帧。\
一场战斗10个玩家参与。

假定每个玩家向服务器发送给服务器的数据包为25个字节，那么每秒服务器发送的数据量为：
..

    25 * 10 * 10 * 40 = 100,000(约100KB)

一场战斗10个玩家需要的带宽大概为800Kb的带宽，100M带宽大概可以同时支撑125场战斗，即1250个玩家。
一个玩家一个月的带宽成本约2元

按TalkingData的数据2017年6份，手游平均付费率低于5%，大概在3%左右。那么100M带宽的付费用户大概\
有55人。仅带宽成本就要求55人平均付费40-50元。

小结
-----
*   每个玩家每月的带宽成本高达\ **2元**\ ；
*   以5%付费率算，带宽成本平摊到玩家，需要付费\ **40-50元**\

RPG游戏
========
由上面MOBA游戏的“恐怖”流量，想到RPG游戏都号称万人同屏，怎么没有这个问题呢？而且设计的时候人没有\
考虑协议包的大小问题。为什么？

仔细思考了一下，原因主要是因发包频率的问题。RPG游戏虽然功能复杂，且协议包都比较大。但是，发包频率\
“很”低。以最频繁的移动同步来说，1s同步一次顶天了。万人国战，虽然人多，但是经过优化，实际发包量也\
不太大；战斗时，技能虽然缤纷多彩，但是技能都有冷却啊(冷却的作用)，手按的再快也是1s一个技能。所以\
RPG万人同屏战斗，经设计和优化后，发包量还是不太大。

回头来说MOBA，为保证流畅，必须要一定的发包(帧)频率。所以必须优化，不然单人成本太高了。

参考资料
==========
*   `百度云价格计算器 <https://cloud.baidu.com/calculator.html#/eip/price>`_
*   `腾讯云价格计算器 <https://buy.qcloud.com/calculator/cvm>`_
*   `阿里云价格计算器 <https://ecs-buy.aliyun.com/?spm=5176.51065.197476.2.uP4LZS#/prepay>`_
*   `TalkingData-2017年5月移动游戏Benchmark <http://mi.talkingdata.com/report-detail.html?id=531>`_
*   `TalkingData-王者荣耀热点报告 <http://mi.talkingdata.com/report-detail.html?id=529>`_
